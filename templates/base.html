{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="description"
          content="A Django Boards application where users respond to topics related to Django created by a superuser">
    <meta name="keywords"
          content="django, python3, boards, topics, topic posts, user authentication, extended built-in user profile, user avatars, csrf tokens, django signals, generic class based views, function based views, bootstrap, pagination">
    <title>
      {% block title %}
        Django Boards
      {% endblock title %}
    </title>
    {% block stylesheet %}
      <!-- fontawesome -->
      <link rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
      <!-- Material icons -->
      <link href="https://fonts.googleapis.com/icon?family=Material+Icons"
            rel="stylesheet">
      <!-- Bootstrap CSS -->
      <link rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.3/css/bootstrap.min.css"
            integrity="sha512-jnSuA4Ss2PkkikSOLtYs8BlYIeeIK1h99ty4YfvRPAlzr377vr3CXDb7sb7eEEBYjDtcYj+AjBH3FLv5uSJuXg=="
            crossorigin="anonymous"
            referrerpolicy="no-referrer" />
      <!-- css/styles.css -->
      <link rel="stylesheet" href="{% static 'css/styles.css' %}">
      <!-- css/app.css -->
      <link rel="stylesheet" href="{% static 'css/app.css' %}">
    {% endblock stylesheet %}
  </head>
  <body class="site">
    {% block body %}
      <div class="site-content">
        {% include "includes/profile-navigation-main.html" %}
        <div class="container">
          <ol class="breadcrumb my-4">
            {% block breadcrumb %}
            {% endblock breadcrumb %}
          </ol>
          {% block content %}
          {% endblock content %}
        </div>
      </div>
      {% include "includes/footer.html" %}
      {% include "includes/scroll-button.html" %}
    {% endblock body %}
    {% block javascript %}
      <script>
      const likeButton = document.getElementById('like-button');
      const likeCount = document.getElementById('like-count');
      likeButton.addEventListener('pointerdown', function() {
          const postId = this.dataset.postId
          fetch(`/like/${postId}/`, {
              method: 'POST',
              headers: {
                  'X-CSRFToken': '{{ csrf_token }}',
              },
          })
          .then(response => {
            if (response.headers.get('Content-Type').includes('application/json')) {
              // Parse as JSON
              return response.json();
            } else if (response.headers.get('Content-Type').includes('text/plain')) {
              // Parse as text
              return response.text();
            } else {
              // Handle other response types or errors
              throw new Error('Unexpected response type');
            }
          })
          .then(data => {
              likeCount.textContent = `Likes: ${data.likes.count}`
              if (data.liked) {
                  likeButton.textContent = '👎';
                  likeCount.textContent = `Likes: ${data.likes.count}`
              } else {
                  likeButton.textContent = '👍'
                  likeCount.textContent = `Likes: ${data.likes.count}`
              }
          }).catch(error => {
            // Handle errors
            console.error(error)
          })
          history.go(0)
      })
      </script>
      <!-- JQuery -->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"
              integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
              crossorigin="anonymous"
              referrerpolicy="no-referrer"></script>
      <!-- Popper JS -->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.9.2/umd/popper.min.js"
              integrity="sha512-2rNj2KJ+D8s1ceNasTIex6z4HWyOnEYLVC3FigGOmyQCZc2eBXKgOxQmo3oKLHyfcj53uz4QMsRCWNbLd32Q1g=="
              crossorigin="anonymous"
              referrerpolicy="no-referrer"></script>
      <!-- Bootstrap JS -->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.3/js/bootstrap.min.js"
              integrity="512-ykZ1QQr0Jy/4ZkvKuqWn4iF3lqPZyij9iRv6sGqLRdTPkY69YX6+7wvVGmsdBbiIfN/8OdsI7HABjvEok6ZopQ=="
              crossorigin="anonymous"
              referrerpolicy="no-referrer"></script>
      <!-- A plugin for password show/hide  -->
      <script src="https://unpkg.com/bootstrap-show-password@1.2.1/dist/bootstrap-show-password.min.js"></script>
      <!-- Clipboard JS -->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.4.0/clipboard.min.js"
              integrity="sha512-iJh0F10blr9SC3d0Ow1ZKHi9kt12NYa+ISlmCdlCdNZzFwjH1JppRTeAnypvUez01HroZhAmP4ro4AvZ/rG0UQ=="
              crossorigin="anonymous"
              referrerpolicy="no-referrer"></script>
      <script type="module" src="{% static 'js/app.js' %}"></script>
    {% endblock javascript %}
  </body>
</html>
